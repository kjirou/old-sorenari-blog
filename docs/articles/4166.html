<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>npm run-script のサブコマンドへ引数を渡したかった | 旧それなりブログ</title>
  </head>
  <body>
    <header>
      <p>旧それなりブログの跡地</p>
      <nav>
        <ul>
          <li><a href="https://kjirou.github.io/old-sorenari-blog/">トップへ</a></li>
          <li><a href="https://kjirou.github.io/blog/">新ブログへ</a></li>
        </ul>
      </nav>
    </header>
    <article>
      <section>
        <h1>npm run-script のサブコマンドへ引数を渡したかった</h1>
        <p>2014年9月5日</p>
      </section>
      <section>
        <div>
npm モジュールを開発する際、自分は主に <tt>npm test</tt> へコマンドをラップしたスクリプトを書いてテストしています。</p>
<p>その場合、以下のようにサブコマンド側へ args や flags を渡したいことがあります。</p>
<p>例えば、mocha コマンドを npm test に設定したとして：</p>
<pre>
scripts: {
  test: "mocha"
}
</pre>
<p></p>
<p>シェルから呼び出す際に：</p>
<pre>
npm test --grep キーワード
</pre>
<p></p>
<p>こういった mocha コマンドへのオプションを実行毎に渡したいな、と。
</p></div>
<h3>現状は無理っぽい</h3>
<div>
英語力が残念なので多分ですが、この辺によると:</p>
<p><a href="https://github.com/npm/npm/issues/3494" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/npm/npm/issues/3494', 'Passing flags and arguments into run-script #3494']);" target="_blank">Passing flags and arguments into run-script #3494</a><br />
<a href="https://github.com/npm/npm/issues/6053" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/npm/npm/issues/6053', 'standalone npm-exec #6053']);" target="_blank">standalone npm-exec #6053</a></p>
<p>現在は無理のようです。</p>
<p>将来的には <tt>npm-exec</tt> がどうにかしてくれるという文脈でしょうか・・・？</p>
<p>（例を見た感じ、逆に複雑なので、それなら <tt>node node_modules/.bin/mocha --grep キーワード</tt> と実行したり、他の方法でラップした方がいいのではという感想です）
</div>
<h3>ちなみに mocha へ固定オプションを渡したいなら</h3>
<div>
<blockquote class="twitter-tweet" lang="ja">
<p><a href="https://twitter.com/kjirou" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://twitter.com/kjirou', '@kjirou']);" >@kjirou</a> mocha.optsじゃできないです？</p>
<p>&mdash; 第三水曜日のいぬ (@shoota) <a href="https://twitter.com/shoota/status/507509243088355328" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://twitter.com/shoota/status/507509243088355328', '2014, 9月 4']);" >2014, 9月 4</a></p></blockquote>
<p><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></p>
<p><tt>mocha.opts</tt> で可能でした。
</div>
<h3>追記: 2014/10/13</h3>
<div>
<a href="https://github.com/npm/npm/pull/5518" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/npm/npm/pull/5518', 'npm 2.0 から引数が渡せるようになるみたい']);" target="_blank">npm 2.0 から引数が渡せるようになるみたい</a>です！</p>
<p>書式は<a href="https://github.com/npm/npm/pull/5518/files#diff-c8ef191c95255343393f2a3256d29483R11" onclick="_gaq.push(['_trackEvent', 'outbound-article', 'https://github.com/npm/npm/pull/5518/files#diff-c8ef191c95255343393f2a3256d29483R11', 'こんな感じ']);" target="_blank">こんな感じ</a>でした。<br />
<tt>--</tt> でサブコマンド側の引数を認識する仕組みでした。
</div>

      </section>
    </article>
  </body>
</html>
